{% extends '@Gui/Layout/layout.twig' %}

{% if widget_title is not defined %}
    {% set widget_title = 'Product Add' | trans %}
{% endif %}

{% if submit_title is not defined %}
    {% set submit_title = 'Add' | trans %}
{% endif %}

{% if idProduct is not defined %}
    {% set idProduct = 0 %}
{% endif %}

{% block head_title -%}
    {{ widget_title | trans }} {% if idProduct > 0 %} [{{ idProduct }}] {% endif %}
{%- endblock %}
{% block section_title %}{{ widget_title }}{% endblock %}

{% block action %}
    {{ backActionButton('/product-management', 'List Products' | trans) }}
{% endblock %}

{% block content %}

    {{ form_start(form) }}

    {% embed '@Gui/Partials/widget.twig' with { widget_title: 'Product Specification' } %}

        {% block widget_content %}

<div class="tabs-container">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab_general" data-toggle="tab">General</a></li>
        <li class=""><a href="#tab_variant" data-toggle="tab">Variants</a></li>
        <li class=""><a href="#tab_attribute" data-toggle="tab">Attributes</a></li>
    </ul>
    <div class="tab-content">
        {# ============================ GENERAL ============================ #}
        <div id="tab_general" class="tab-pane active">
            <div class="panel-body">

                {{ form_row(form.sku) }}

                <div class="tabs-container">
                    <ul class="nav nav-tabs">
                        {% for locale,localizedAttributes in form.localized_attributes %}
                            {% set activeCss = '' %}
                            {% set invalidCss = '' %}

                            {% if currentLocale == locale %}
                                {% set activeCss =  'active' %}
                            {% endif %}

                            {% if errors.localized_attributes is defined %}
                                {% if locale in errors.localized_attributes|keys %}
                                    {% set invalidCss = 'invalid-tab' %}
                                {% endif %}
                            {% endif %}

                            <li class="{{ activeCss }} {{ invalidCss }}"><a href="#content_{{ locale }}" data-toggle="tab">{{ locale }}</a></li>
                        {% endfor %}
                    </ul>

                    <div class="tab-content">
                        {% for locale,localizedAttributes in form.localized_attributes %}
                            {% set active = '' %}
                            {% if currentLocale == locale %}
                                {% set active = 'active' %}
                            {% endif %}

                            <div id="content_{{ locale }}" class="tab-pane {{ active }}">
                                <div class="panel-body">
                                    {{ form_errors(localizedAttributes.name) }}
                                    {{ form_row(localizedAttributes.name) }}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>

            </div>
        </div>
        {# ============================ END ============================ #}

        {# ============================ VARIANT ============================ #}
        <div id="tab_variant" class="tab-pane">
            <div class="panel-body">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        Attributes
                    </div>
                    <div class="panel-body">
                        {{ form_errors(form) }}
                        <div class="row">
                            <div class="col-lg-4">
                                {% for type,attributes in form.attributes %}
                                <div class="well">
                                    {{ form_errors(attributes.value) }}
                                    {{ form_row(attributes.value) }}
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover dataTables-example" >
                        <thead>
                        <tr>
                            <th>Sku</th>
                            {% set break1 = false %}
                            {% for product in concretes if not break1 %}
                                {% for attrName, attrValue in product.attributes %}
                                    {% set break1 = true %}
                                    <th>{{ attrName }}</th>
                                {% endfor %}
                            {% endfor %}
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for product in concretes %}
                            <tr class="gradeX">
                                <td>{{ product.sku }}</td>
                                {% for attr in product.attributes %}
                                    <td>{{ attr }}</td>
                                {% endfor %}
                                <td class="center">[activate]</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                        <tfoot>
                        <tr>
                            <th>Sku</th>
                            {% set break1 = false %}
                            {% for product in concretes if not break1 %}
                                {% for attrName, attrValue in product.attributes %}
                                    {% set break1 = true %}
                                    <th>{{ attrName }}</th>
                                {% endfor %}
                            {% endfor %}
                            <th>Action</th>
                        </tr>
                        </tfoot>
                    </table>
                </div>

            </div>
        </div>
        {# ============================ END ============================ #}

        {# ============================ ATTRIBUTE ============================ #}
        <div id="tab_attribute" class="tab-pane">
            <div class="panel-body">

                attrubute

            </div>
        </div>
        {# ============================ END ============================ #}
    </div>
</div>

        {% endblock %}

    {% endembed %}

    <input type="submit" class="btn btn-primary" value="{{ submit_title | trans }}"/>

    {{ form_end(form) }}

{% endblock %}

{% block head_css %}
    {{ parent() }}
    <link rel="stylesheet" href="/assets/css/spryker-zed-productmanagement-main.css" />
{% endblock %}

{% block footer_js %}
    {{ parent() }}
    <script src="/assets/js/spryker-zed-productmanagement-main.js"></script>
{% endblock %}
