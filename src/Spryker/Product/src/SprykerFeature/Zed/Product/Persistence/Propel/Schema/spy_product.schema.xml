<?xml version="1.0"?>
<database xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" name="zed" xsi:noNamespaceSchemaLocation="http://xsd.propelorm.org/1.6/database.xsd" namespace="Orm\Zed\Product\Persistence" identifierQuoting="true" package="src.Orm.Zed.Product.Persistence">

    <table name="spy_abstract_product" idMethod="native" allowPkInsert="true" phpName="SpyAbstractProduct">
        <column name="id_abstract_product" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="sku" required="true" type="VARCHAR" size="255"/>
        <column name="attributes" required="true" type="LONGVARCHAR"/>
        <column name="fk_tax_set" type="INTEGER" required="false"/>
        <foreign-key foreignTable="spy_tax_set">
            <reference local="fk_tax_set" foreign="id_tax_set"/>
        </foreign-key>
        <unique>
            <unique-column name="sku"/>
        </unique>
        <behavior name="timestampable"/>
        <id-method-parameter value="spy_abstract_product_pk_seq"/>
    </table>

    <table name="spy_abstract_product_localized_attributes" idMethod="native" allowPkInsert="true" phpName="SpyLocalizedAbstractProductAttributes" identifierQuoting="true">
        <column name="id_abstract_attributes" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="fk_abstract_product" required="true" type="INTEGER"/>
        <column name="fk_locale" required="true" type="INTEGER"/>
        <column name="name" required="true" type="VARCHAR"/>
        <column name="attributes" required="true" type="LONGVARCHAR"/>
        <foreign-key foreignTable="spy_abstract_product" onDelete="CASCADE" onUpdate="CASCADE">
            <reference local="fk_abstract_product" foreign="id_abstract_product"/>
        </foreign-key>
        <foreign-key foreignTable="spy_locale" phpName="Locale">
            <reference local="fk_locale" foreign="id_locale"/>
        </foreign-key>
        <unique>
            <unique-column name="fk_abstract_product"/>
            <unique-column name="fk_locale"/>
        </unique>
        <behavior name="timestampable"/>
        <id-method-parameter value="spy_abstract_product_localized_attributes_pk_seq"/>
    </table>

    <table name="spy_product" idMethod="native" allowPkInsert="true" phpName="SpyProduct" identifierQuoting="true">
        <column name="id_product" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="sku" required="true" type="VARCHAR" size="255"/>
        <column name="is_active" required="true" defaultValue="true" type="BOOLEAN"/>
        <column name="attributes" required="true" type="LONGVARCHAR"/>
        <column name="fk_abstract_product" required="true" type="INTEGER"/>
        <unique>
            <unique-column name="sku"/>
        </unique>
        <foreign-key foreignTable="spy_abstract_product">
            <reference local="fk_abstract_product" foreign="id_abstract_product"/>
        </foreign-key>
        <behavior name="timestampable"/>
        <id-method-parameter value="spy_product_pk_seq"/>
    </table>

    <table name="spy_product_localized_attributes" idMethod="native" allowPkInsert="true" phpName="SpyLocalizedProductAttributes" identifierQuoting="true">
        <column name="id_attributes" required="true" type="INTEGER" primaryKey="true" autoIncrement="true"/>
        <column name="fk_product" required="true" type="INTEGER"/>
        <column name="fk_locale" required="true" type="INTEGER"/>
        <column name="name" required="true" type="VARCHAR"/>
        <column name="attributes" required="true" type="LONGVARCHAR"/>
        <column name="is_complete" required="false" defaultValue="true" type="BOOLEAN"/>
        <foreign-key foreignTable="spy_product" onDelete="CASCADE" onUpdate="CASCADE">
            <reference local="fk_product" foreign="id_product"/>
        </foreign-key>
        <foreign-key foreignTable="spy_locale" phpName="Locale">
            <reference local="fk_locale" foreign="id_locale"/>
        </foreign-key>
        <unique>
            <unique-column name="fk_product"/>
            <unique-column name="fk_locale"/>
        </unique>
        <behavior name="timestampable"/>
        <id-method-parameter value="spy_product_localized_attributes_pk_seq"/>
    </table>

    <table name="spy_product_to_bundle" identifierQuoting="true">
        <column name="fk_product" type="INTEGER" required="true" primaryKey="true"/>
        <column name="fk_related_product" type="INTEGER" required="true" primaryKey="true"/>
        <foreign-key foreignTable="spy_product">
            <reference local="fk_product" foreign="id_product"/>
        </foreign-key>
        <foreign-key foreignTable="spy_product" phpName="BundleProduct" refPhpName="BundleProduct">
            <reference local="fk_related_product" foreign="id_product"/>
        </foreign-key>
    </table>

    <table name="spy_attributes_metadata" idMethod="native" allowPkInsert="true" phpName="SpyProductAttributesMetadata" identifierQuoting="true">
        <column name="id_attributes_metadata" primaryKey="true" type="INTEGER" autoIncrement="true"/>
        <column name="key" required="true" type="VARCHAR"/>
        <column name="is_editable" required="true" defaultValue="true" type="BOOLEAN"/>
        <column name="fk_type" type="INTEGER"/>
        <foreign-key foreignTable="spy_attribute_type">
            <reference local="fk_type" foreign="id_type"/>
        </foreign-key>
        <id-method-parameter value="spy_attributes_metadata_pk_seq"/>
    </table>

    <table name="spy_attribute_type" idMethod="native" allowPkInsert="true" phpName="SpyProductAttributeType" identifierQuoting="true">
        <column name="id_type" type="INTEGER" autoIncrement="true" primaryKey="true"/>
        <column name="name" type="VARCHAR" required="true"/>
        <column name="fk_parent_type" type="INTEGER" required="false"/>
        <column name="input_representation" type="VARCHAR" required="true"/>
        <foreign-key foreignTable="spy_attribute_type">
            <reference local="fk_parent_type" foreign="id_type"/>
        </foreign-key>
        <id-method-parameter value="spy_attribute_type_pk_seq"/>
    </table>

    <table name="spy_attribute_type_value" idMethod="native" allowPkInsert="true" phpName="SpyTypeValue" identifierQuoting="true">
        <column name="id" autoIncrement="true" primaryKey="true" type="INTEGER"/>
        <column name="fk_type" type="INTEGER" required="true"/>
        <column name="key" type="VARCHAR" required="true"/>
        <column name="value" type="VARCHAR" required="true"/>
        <column name="fk_locale" type="INTEGER" required="false"/>
        <foreign-key foreignTable="spy_locale" phpName="Locale">
            <reference local="fk_locale" foreign="id_locale"/>
        </foreign-key>
        <unique>
            <unique-column name="fk_locale"/>
            <unique-column name="fk_type"/>
            <unique-column name="key"/>
        </unique>
        <id-method-parameter value="spy_attribute_type_value_pk_seq"/>
    </table>
</database>
